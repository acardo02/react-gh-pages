(this["webpackJsonpproyecto-final"]=this["webpackJsonpproyecto-final"]||[]).push([[0],{43:function(e,t,a){},44:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var s=a(2),c=a.n(s),n=a(32),r=a.n(n),l=(a(43),a(44),a(5)),i=a.n(l),o=a(6),u=a(4),x=a(12),j=a(7),m=a.n(j),d=a(15),b=a.n(d),p=a(3),f=a(10),h=a(1),O="https://posts-pw2021.herokuapp.com/api/v1/auth",w=function(){b()({title:"Parametros vacios",text:"Por favor llene todos los campos",icon:"warning",button:"Aceptar",timer:3e3})},v=function(e){var t="",a="";401===e.status?(t="Usuario o contrase\xf1a incorrectos",a="Error 401"):500===e.status?(t="Error del servidor",a="Error 500"):404===e.status&&(a="Error 404",t="Usuario no encontrado"),b()({title:a,text:t,icon:"error",button:"Aceptar",timer:3e3})},g=function(){var e=Object(p.g)(),t=Object(s.useRef)(null),a=Object(s.useRef)(null),c=Object(s.useState)(!0),n=Object(u.a)(c,2),r=n[0],l=n[1];function j(){return(j=Object(o.a)(i.a.mark((function s(c){var n,r,l;return i.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return c.preventDefault(),n=t.current.value,r=a.current.value,""!==n&&""!==r||w(),s.prev=4,s.next=7,m.a.post("".concat(O,"/signin"),{username:n,password:r});case 7:200===(l=s.sent).status&&(localStorage.setItem("token",l.data.token),localStorage.setItem("role",l.data.role),e("/")),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(4),v(s.t0.response);case 14:case"end":return s.stop()}}),s,null,[[4,11]])})))).apply(this,arguments)}return Object(h.jsxs)("form",{className:"text-black flex flex-col justify-center mx-auto items-center w-80 h-screen max-w-screen-sm md:w-auto",onSubmit:function(e){return j.apply(this,arguments)},children:[Object(h.jsxs)("div",{className:"flex flex-col space-y-1 my-2",children:[Object(h.jsxs)("label",{htmlFor:"l-username",className:"text-lg font-medium font-mono inline-flex",children:[Object(h.jsx)(x.c,{className:"mr-1"})," Username"]}),Object(h.jsx)("input",{className:"border-2 rounded-lg",id:"l-username",placeholder:"Username",type:"text",ref:t})]}),Object(h.jsxs)("div",{className:"flex flex-col space-y-1 justify-center ml-4",children:[Object(h.jsxs)("label",{htmlFor:"l-password",className:"text-lg font-medium font-mono inline-flex",children:[Object(h.jsx)(x.b,{className:"mr-1"})," Password"]}),Object(h.jsxs)("div",{className:"inline-flex justify-center items-center",children:[Object(h.jsx)("input",{className:"border-2 rounded-lg",id:"l-password",placeholder:"Password",type:"",ref:a}),r?Object(h.jsx)(f.c,{className:"w-5 h-5 ml-2",onClick:function(){var e=document.getElementById("l-password");l(!r),e.type="text"}}):Object(h.jsx)(f.b,{className:"w-5 h-5",onClick:function(){var e=document.getElementById("l-password");l(!r),e.type="password"}})]})]}),Object(h.jsx)("button",{className:"w-full bg-black text-white rounded-2xl py-2 my-3",type:"submit",children:"Login"})]})},y=a(33),N=function(){return Object(h.jsxs)("div",{className:"flex flex-col justify-center items-center absolute top-0 left-0 z-20 bg-white h-screen w-screen",children:[Object(h.jsx)(y.a,{className:"text-black animate-spin",size:50}),Object(h.jsx)("h1",{className:"font-bold text-3xl",children:"Loading...."})]})},k=a(13),S=a(38),I=a(34),E=a.n(I),A=a(35),B=function(e){var t=e.info,a=t.description,s=t.user;return Object(h.jsxs)("div",{className:"w-full border-t my-3",children:[Object(h.jsxs)("h1",{className:"mt-2 text-black text-sm font-medium text-blue-400",children:["@",null===s||void 0===s?void 0:s.username]}),Object(h.jsx)("p",{className:"text-xs pl-4",children:a})]})},F=function(e){var t=e.post,a=e.afterSubmit,c=Object(s.useState)(""),n=Object(u.a)(c,2),r=n[0],l=n[1];function x(){return(x=Object(o.a)(i.a.mark((function e(s){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),c={description:r},e.next=4,m.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/comment/".concat(t),c,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 4:l(""),a(c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsx)("form",{className:"w-full",onSubmit:function(e){return x.apply(this,arguments)},children:Object(h.jsx)("input",{value:r,onChange:function(e){l(e.target.value)},className:"px-4 py-2 w-full rounded-2xl text-gray-800 border-2 border-blue-500 text-xs",type:"text",placeholder:"Presiona enter para comentar"})})},z=function(e){var t=e.username,a=e.struct,c=a._id,n=a.title,r=a.description,l=a.image,j=a.user,d=a.createdAt,b=a.likes,p=a.comments,f=Object(s.useState)(b.includes({username:t})),O=Object(u.a)(f,2),w=O[0],v=O[1],g=Object(s.useState)(b.length),y=Object(u.a)(g,2),N=y[0],I=y[1],z=Object(s.useState)(!1),D=Object(u.a)(z,2),C=D[0],P=D[1],L=Object(s.useState)(p),U=Object(u.a)(L,2),_=U[0],J=U[1];function M(){return(M=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/like/".concat(c),null,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:t=e.sent,t.data,w?(I(N-1),v(!1)):(I(N+1),v(!0)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}return Object(h.jsxs)("div",{className:"flex flex-col bg-red-400 bg-opacity-30 rounded-2xl w-full md:w-72 lg:w-96 p-4 text-black my-4",children:[Object(h.jsxs)("div",{className:"w-full flex space-around font-bold text-black",children:[Object(h.jsxs)("h1",{className:"w-1/2",children:["@",null===j||void 0===j?void 0:j.username]}),Object(h.jsx)("h2",{className:"text-right w-1/2",children:new Date(d).toLocaleDateString()})]}),l&&Object(h.jsx)("img",{className:"w-full h-40 object-cover my-2 rounded-2xl",src:l,alt:"imagen cualquiera"}),Object(h.jsxs)("div",{className:"w-full flex flex-col font-medium text-sm space-y-2",children:[Object(h.jsx)("h1",{className:"",children:n}),Object(h.jsx)("h2",{className:"font-normal text-xs",children:r})]}),Object(h.jsxs)("div",{className:"w-full mt-4 flex text-white justify-center",children:[Object(h.jsxs)("button",{onClick:function(){return M.apply(this,arguments)},type:"button",className:"flex space-x-2 text-xs justify-center items-center w-1/2 ".concat(w&&"text-red-600"),children:[Object(h.jsx)("span",{children:Object(h.jsx)(A.a,{className:"mr-2 w-5 h-5 mx-0"})}),N]}),Object(h.jsxs)("button",{onClick:function(){return P(!C)},type:"button",className:"flex space-x-2 text-xs justify-centAiOutlineHearter items-center w-1/2 ".concat(C&&"text-blue-400"),children:[Object(h.jsx)("span",{children:Object(h.jsx)(x.a,{className:"mr-2 text-black w-5 h-5 mx-0"})}),_.length]})]}),Object(h.jsxs)("div",{className:"".concat(!C&&"hidden"," mt-4 w-full flex flex-col items-start"),children:[p&&_.map((function(e){return Object(h.jsx)(B,{info:e},E.a.generate())})),Object(h.jsx)(F,{post:c,afterSubmit:function(e){var a=[].concat(Object(S.a)(_),[Object(k.a)(Object(k.a)({},e),{},{user:{username:t}})]);J(a)}})]})]})},D=function(e){var t=e.username,a=Object(s.useState)({status:"loading",data:null}),c=Object(u.a)(a,2),n=c[0],r=c[1];return Object(s.useEffect)((function(){function e(){return(e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("https://posts-pw2021.herokuapp.com/api/v1/post/all?limit=10&page=1",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:t=e.sent,a=t.data,r({status:"DONE",data:a.data});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),"loading"===n.status?Object(h.jsx)(N,{}):Object(h.jsx)("div",{className:"flex flex-col px-6 py-10 justify-center items-center",children:n.data&&n.data.map((function(e){return Object(h.jsx)(z,{username:t,struct:e},e._id)}))})},C=function(){function e(){return(e=Object(o.a)(i.a.mark((function e(t){var a,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=new FormData(t.target),s=Object.fromEntries(a.entries()),console.log(s),""!==s.title&&""!==s.description){e.next=6;break}return e.abrupt("return",alert("Asegurate de llenar el titulo y la descripcion"));case 6:return e.next=8,m.a.post("https://posts-pw2021.herokuapp.com/api/v1/post/create",Object(k.a)(Object(k.a)({},s),{},{active:"true"===s.active}),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 8:c=e.sent,console.log(c);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("form",{className:"lg:w-96 rounded-2xl bg-black mt-4 p-4 font-bold space-y-3 rounded-lg",onSubmit:function(t){return e.apply(this,arguments)},children:[Object(h.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(h.jsx)("label",{className:"text-white",htmlFor:"title",children:"T\xedtulo"}),Object(h.jsx)("input",{classsName:"rounded-full text-gray-200 px-2 py-1 my-1 rounded-xl",type:"text",name:"title",id:"title"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(h.jsx)("label",{className:"text-white",htmlFor:"description",children:"Descripci\xf3n"}),Object(h.jsx)("input",{classsName:"text-gray-700 ropunded-full px-2 py-1 my-1",type:"text",name:"description",id:"description"})]}),Object(h.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(h.jsx)("label",{className:"text-white",htmlFor:"image",children:"Imagen"}),Object(h.jsx)("input",{classsName:"text-gray-700 ropunded-full px-2 py-1 my-1",type:"text",name:"image",id:"image"})]}),Object(h.jsxs)("div",{className:"flex flex-row text-sm items-center justify-center",children:[Object(h.jsxs)("div",{className:"flex text-sm w-1/3",children:[Object(h.jsx)("label",{className:"text-white",htmlFor:"active",children:"Activo"}),Object(h.jsx)("input",{className:"rounded-xl mx-2",type:"checkbox",name:"active",id:"active"})]}),Object(h.jsxs)("button",{type:"submit",className:"bg-blue-500 w-2/3 rounded-2xl text-center flex py-1 justify-center items-center font-bold",children:[Object(h.jsx)(f.a,{className:"mr-2 h-5 w-5"}),"Publicar"]})]})]})},P=function(){var e=Object(s.useState)(),t=Object(u.a)(e,2),a=t[0],c=t[1],n=Object(s.useState)(!1),r=Object(u.a)(n,2),l=r[0],x=r[1],j=Object(p.g)(),d=localStorage.getItem("token"),b=localStorage.getItem("role");return Object(s.useEffect)((function(){function e(){return(e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get('https://posts-pw2021.herokuapp.com/api/v1/auth/whoami"',{headers:{Autorization:"Bearer ".concat(d)}});case 2:t=e.sent,a=t.data,c(a.username);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null===d&&(j("/login"),function(){e.apply(this,arguments)}())}),[]),Object(h.jsxs)("div",{children:["admin"===b&&Object(h.jsxs)("div",{className:"px-6",children:[Object(h.jsx)("button",{onClick:function(){return x(!l)},type:"button",className:"w-full md:w-72 lg:w-80 flex justify-center mt-3 p-4 bg-white bg-opacity-30 rounded-2xl",children:Object(h.jsx)(f.d,{className:"stroke text-white h-6 w-6"})}),l&&Object(h.jsx)(C,{})]}),Object(h.jsx)(D,{username:a})]})},L=function(e){var t=e.username,a=Object(s.useState)({status:"loading",data:null}),c=Object(u.a)(a,2),n=c[0],r=c[1];return Object(s.useEffect)((function(){function e(){return(e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("https://posts-pw2021.herokuapp.com/api/v1/post/owned?limit=15&page=0",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:t=e.sent,a=t.data,r({status:"DONE",data:a.data});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),"loading"===n.status?Object(h.jsx)(N,{}):Object(h.jsx)("div",{className:"flex flex-col px-6 py-10 justify-center items-center",children:n.data&&n.data.map((function(e){return Object(h.jsx)(z,{username:t,struct:e},e._id)}))})},U=function(){return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(L,{username:"gp50-admin"})})},_=a(37),J=a(36),M=function(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),a=t[0],c=t[1];return Object(h.jsxs)("nav",{className:"w-screen flex flex-col items-end relative",children:[Object(h.jsxs)("div",{className:"w-full flex justify-between items-center",children:[Object(h.jsx)("h1",{className:"pl-4 text-white font-medium text-2xl",children:"Bienvenido nombre"}),a?Object(h.jsx)(J.a,{className:"p-2 stroke text-white h-9 w-9 lg:h-15 lg:w-15",onClick:function(){return c(!a)}}):Object(h.jsx)(_.a,{className:"p-2 stroke text-black h-9 w-9 lg:h-15 lg:w-15 ",onClick:function(){return c(!a)}})]}),Object(h.jsxs)("ul",{className:"".concat(a?"":"hidden"," var text-white bg-black w-screen h-screen max-w-xs absloute nt-10 z-10"),children:[Object(h.jsx)("li",{className:"font-bold text-xl h-20 flex justify-center items-center hover:bg-white hover:text-black",children:"Inicio"}),Object(h.jsx)("li",{className:"font-bold text-xl h-20 flex justify-center items-center hover:bg-white hover:text-black",children:"Favoritos"}),Object(h.jsx)("li",{className:"font-bold text-xl h-20 flex justify-center items-center hover:bg-white hover:text-black",children:"Mis Posts"})]})]})},R=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(M,{}),Object(h.jsx)("div",{children:Object(h.jsx)(p.a,{})})]})},q=a(19),H=function(){return Object(h.jsx)(q.a,{children:Object(h.jsxs)(p.d,{children:[Object(h.jsxs)(p.b,{element:Object(h.jsx)(R,{}),children:[Object(h.jsx)(p.b,{exact:!0,path:"/",element:Object(h.jsx)(P,{})}),Object(h.jsx)(p.b,{exact:!0,path:"/Posts",element:Object(h.jsx)(U,{})})]}),Object(h.jsx)(p.b,{exact:!0,path:"/Login",element:Object(h.jsx)(g,{})})]})})};r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(H,{})}),document.getElementById("root"))}},[[73,1,2]]]);
//# sourceMappingURL=main.2b4d796e.chunk.js.map